

#include <stdio.h>
#include "platform.h"
#include "xil_printf.h"
#include "xgpiops.h"
#include "xparameters.h"


#define sw1 50


XGpioPs_Config *gpio_config;
XGpioPs gpio;



void delay(uint64_t dly){
while(dly--);
}
void gpio_init(){

	gpio_config = XGpioPs_LookupConfig(XPAR_PS7_GPIO_0_DEVICE_ID);
	int status = XGpioPs_CfgInitialize(&gpio, gpio_config, gpio_config -> BaseAddr);
	if(status == XST_SUCCESS)
		xil_printf("GPIO INIT SUCCESSFUL\r\n");
	else
		xil_printf("GPIO INIT FAILED\r\n");

}


int main()
{
    init_platform();
    gpio_init();
    xil_printf("Start\r\n");

    XGpioPs_SetDirectionPin(&gpio, sw1, 0);
    XGpioPs_SetOutputEnablePin(&gpio,sw1,1);
    while(1){
    	u32 data_status= XGpioPs_ReadPin(&gpio, sw1);
    	xil_printf("Value read: %0d  \r\n",data_status);
    	sleep(1);
    }

    cleanup_platform();
    return 0;
}
